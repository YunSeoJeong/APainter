# APainter 코드 지침

## 1. 일반 지침

*   **가독성:** 코드는 명확하고 이해하기 쉽게 작성합니다.
*   **주석:** 코드의 목적과 동작 방식을 설명하는 주석을 적절하게 작성합니다.
*   **SOLID 원칙:** SOLID 원칙을 준수하여 코드를 설계합니다.
*   **DRY 원칙:** DRY (Don't Repeat Yourself) 원칙을 준수하여 코드 중복을 최소화합니다.
*   **예외 처리:** 예외 처리를 통해 예상치 못한 오류에 대비합니다.
*   **테스트:** 작성된 코드에 대한 단위 테스트를 작성합니다.

## 2. C# 코딩 스타일

*   **들여쓰기:** 4개의 공백 문자를 사용합니다.
*   **괄호:** 메서드, 루프, 조건문 등에서 항상 괄호를 사용합니다.
*   **using 지시문:** using 지시문은 namespace 선언 외부에 작성합니다.
*   **null 검사:** null 값을 가질 수 있는 변수에 대해서는 null 검사를 수행합니다.
*   **var 키워드:** 지역 변수 선언 시 var 키워드 사용을 권장합니다 (타입 추론이 가능한 경우).

## 3. WinForms 코딩 스타일

*   **UI 스레드:** UI 관련 작업은 반드시 UI 스레드에서 수행합니다.
*   **데이터 바인딩:** 데이터 바인딩을 활용하여 UI와 데이터 간의 결합도를 낮춥니다.
*   **컨트롤 이벤트:** 컨트롤 이벤트 처리 시 이벤트 핸들러 메서드를 사용합니다.

## 4. ComfyUI 연동 코딩 스타일

*   **비동기 프로그래밍:** ComfyUI API 호출 시 비동기 프로그래밍 (async/await)을 사용합니다.
*   **JSON 처리:** JSON serialization/deserialization 시 Newtonsoft.Json 라이브러리를 사용합니다.
*   **API 키 관리:** API 키는 안전하게 관리하고, 코드에 직접 포함하지 않습니다.

## 5. 성능 고려 사항

*   **Bitmap 처리:** Bitmap 객체 처리 시 LockBits 메서드를 사용하여 성능을 최적화합니다.
*   **GPU 사용량:** ComfyUI API 호출 빈도를 조절하여 GPU 사용량을 줄입니다.
*   **메모리 관리:** 불필요한 객체 생성을 줄이고, using 구문을 사용하여 리소스를 해제합니다.

## 6. 클래스 간 참조 (Class References)

*   **DI (Dependency Injection):** 클래스 간의 의존성을 줄이기 위해 DI 컨테이너를 사용합니다.
*   **인터페이스:** 클래스 간의 결합도를 낮추기 위해 인터페이스를 활용합니다.
*   **최소 지식 원칙 (Law of Demeter):** 객체는 자신이 직접 관계하는 객체에만 메시지를 보내도록 합니다.
*   **순환 참조 방지:** 클래스 간의 순환 참조가 발생하지 않도록 주의합니다.